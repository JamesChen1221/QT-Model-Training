# 趨勢斜率特徵提取總結 (方案 B: 標準化價格)

## 提取方法

從 `120天收盤價序列` 欄位提取 15 個趨勢斜率特徵:

### 處理流程
1. 讀取絕對價格序列: `[119.6, 116.37, 123.74, ...]`
2. **標準化**: 將每段價格除以該段第一天的價格
3. 使用重疊窗口切段，計算每段的線性回歸斜率

### 標準化的好處
- 不同價格的股票可以公平比較
- 斜率直接反映百分比變化
- GOOG ($330) 和 ELF ($85) 的趨勢可以用相同標準衡量

### 15 個特徵

**120天 5段** (每段約 24 天):
- `120d_seg1_slope`: 第 0-24 天趨勢斜率
- `120d_seg2_slope`: 第 24-48 天趨勢斜率
- `120d_seg3_slope`: 第 48-72 天趨勢斜率
- `120d_seg4_slope`: 第 72-96 天趨勢斜率
- `120d_seg5_slope`: 第 96-120 天趨勢斜率

**60天 5段** (每段約 12 天，使用最近 61 天):
- `60d_seg1_slope`: 第 0-12 天
- `60d_seg2_slope`: 第 12-24 天
- `60d_seg3_slope`: 第 24-36 天
- `60d_seg4_slope`: 第 36-48 天
- `60d_seg5_slope`: 第 48-60 天

**5天 5段** (每段約 1 天，使用最近 6 天):
- `5d_seg1_slope`: 第 0-1 天
- `5d_seg2_slope`: 第 1-2 天
- `5d_seg3_slope`: 第 2-3 天
- `5d_seg4_slope`: 第 3-4 天
- `5d_seg5_slope`: 第 4-5 天

## 提取結果範例

### ELF 股票
```
120天 5段斜率:
  段1:  +0.0107  (每天漲 1.07%)
  段2:  -0.0023  (每天跌 0.23%)
  段3:  -0.0265  (每天跌 2.65%)
  段4:  +0.0016  (每天漲 0.16%)
  段5:  +0.0031  (每天漲 0.31%)

趨勢模式: 上升 → 持平 → 下降 → 持平 → 上升
解讀: 經歷中期回調後，最近兩段持續上升

60天 5段斜率:
  段1:  -0.0091  (每天跌 0.91%)
  段2:  +0.0073  (每天漲 0.73%)
  段3:  +0.0014  (每天漲 0.14%)
  段4:  +0.0166  (每天漲 1.66%)
  段5:  -0.0089  (每天跌 0.89%)

趨勢模式: 下降 → 上升 → 持平 → 強勢上升 → 下降
解讀: 最近出現回調

5天 5段斜率:
  段1:  +0.0006  (每天漲 0.06%)
  段2:  -0.0005  (每天跌 0.05%)
  段3:  +0.0137  (每天漲 1.37%)
  段4:  -0.0158  (每天跌 1.58%)
  段5:  -0.0021  (每天跌 0.21%)

趨勢模式: 持平 → 持平 → 上升 → 下降 → 持平
解讀: 短期波動，最近趨於持平
```

### GOOG 股票
```
120天 5段斜率:
  段1:  +0.0122  (每天漲 1.22%)
  段2:  -0.0001  (持平)
  段3:  +0.0086  (每天漲 0.86%)
  段4:  -0.0021  (每天跌 0.21%)
  段5:  +0.0050  (每天漲 0.50%)

趨勢模式: 強勢上升 → 持平 → 上升 → 持平 → 上升
解讀: 長期穩定上升趨勢

60天 5段斜率:
  段1:  +0.0058  (每天漲 0.58%)
  段2:  -0.0009  (持平)
  段3:  +0.0022  (每天漲 0.22%)
  段4:  +0.0072  (每天漲 0.72%)
  段5:  +0.0043  (每天漲 0.43%)

趨勢模式: 上升 → 持平 → 上升 → 上升 → 上升
解讀: 最近 60 天持續上升

5天 5段斜率:
  段1:  +0.0071  (每天漲 0.71%)
  段2:  -0.0004  (持平)
  段3:  +0.0189  (每天漲 1.89%)
  段4:  -0.0125  (每天跌 1.25%)
  段5:  -0.0219  (每天跌 2.19%)

趨勢模式: 上升 → 持平 → 強勢上升 → 下降 → 下降
解讀: 短期出現回調
```

### MSTR 股票
```
120天 5段斜率:
  段1:  -0.0029  (每天跌 0.29%)
  段2:  -0.0056  (每天跌 0.56%)
  段3:  -0.0148  (每天跌 1.48%)
  段4:  -0.0034  (每天跌 0.34%)
  段5:  -0.0036  (每天跌 0.36%)

趨勢模式: 下降 → 下降 → 強勢下降 → 下降 → 下降
解讀: 持續下降趨勢，第3段跌幅最大

60天 5段斜率:
  段1:  -0.0259  (每天跌 2.59%)
  段2:  +0.0032  (每天漲 0.32%)
  段3:  -0.0054  (每天跌 0.54%)
  段4:  +0.0054  (每天漲 0.54%)
  段5:  -0.0162  (每天跌 1.62%)

趨勢模式: 強勢下降 → 反彈 → 下降 → 反彈 → 下降
解讀: 波動劇烈，最近再次下跌

5天 5段斜率:
  段1:  +0.0455  (每天漲 4.55%)
  段2:  -0.0704  (每天跌 7.04%)
  段3:  -0.0445  (每天跌 4.45%)
  段4:  -0.0291  (每天跌 2.91%)
  段5:  -0.1543  (每天跌 15.43%)

趨勢模式: 上升 → 暴跌 → 下降 → 下降 → 暴跌
解讀: 短期劇烈下跌
```

## 斜率數值解讀

**數值含義**:
- `+0.01` = 每天平均上漲 1%
- `+0.005` = 每天平均上漲 0.5% (溫和上升)
- `0.0` = 持平
- `-0.005` = 每天平均下跌 0.5% (溫和下降)
- `-0.01` = 每天平均下跌 1%

**趨勢強度分類**:
- `> +0.01` = 強勢上升
- `+0.003 ~ +0.01` = 溫和上升
- `-0.003 ~ +0.003` = 持平/盤整
- `-0.01 ~ -0.003` = 溫和下降
- `< -0.01` = 強勢下降

**趨勢模式識別**:
- `[+, +, +, +, +]` = 持續上升趨勢
- `[-, -, -, -, -]` = 持續下降趨勢
- `[-, -, +, +, +]` = V型反轉
- `[+, +, -, -, -]` = 倒V型
- `[-, +, -, +, -]` = 劇烈波動

## 模型訓練結果

- 成功訓練 4 個模型 (4 個預測目標)
- 使用 15 個趨勢斜率特徵 + 其他特徵 (共 37 個特徵)
- 已忽略 ADX/RSI 序列特徵
- 訓練集 R² = 1.0 (完美擬合，但資料太少會過擬合)
- 測試集 R² < 0 (過擬合嚴重，需要更多資料)

## 與其他方案的比較

### 方案 A (絕對價格斜率)
- GOOG: 斜率 = +5.0 (每天漲 $5)
- ELF: 斜率 = +1.0 (每天漲 $1)
- 問題: 無法公平比較

### 方案 B (標準化價格斜率) ✓ 當前使用
- GOOG: 斜率 = +0.015 (每天漲 1.5%)
- ELF: 斜率 = +0.012 (每天漲 1.2%)
- 優點: 公平比較，直接反映百分比

### 方案 C (變化率斜率)
- 類似方案 B，但計算方式不同
- 結果相近

## 下一步

1. **收集更多資料**: 目前只有 10 筆，建議累積到 50+ 筆
2. **觀察特徵重要性**: 等資料多了，查看哪些時間段的斜率最重要
3. **分析趨勢模式**: 看看哪些趨勢模式對應高當沖潛力
4. **持續優化**: 根據實際預測效果調整特徵

## 特徵使用建議

**當資料達到 50+ 筆時**:
- 查看特徵重要性排名
- 可能發現某些時間段的斜率特別重要
- 例如: 最近 5 天的趨勢可能比 120 天更重要

**當資料達到 200+ 筆時**:
- 可以考慮增加更多時間尺度 (10天、30天等)
- 或者提取更多統計特徵 (波動率、加速度等)

